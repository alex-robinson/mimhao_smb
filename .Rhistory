TOPO_BEDMAP2$H[which(mask_super==3)]
which(mask_super==3)
which(mask_super==20)
TOPO_BEDMAP2$H[12990]
TOPO_BEDMAP2$H[13130]
which(mask_super==21)
which(mask_super==22)
which(mask_super==23)
TOPO_BEDMAP2$H[13130]
TOPO_BEDMAP2$H[12124]
TOPO_BEDMAP2$H[121212]
TOPO_BEDMAP2$H[1212]
TOPO_BEDMAP2$H[12]
TOPO_BEDMAP2$H[23]
TOPO_BEDMAP2$H[2300]
rm(TOPO_BEDMAP2)
source('load_data.r')
Dep  = - TOPO_BEDMAP2$zb     # Depth with positive sign
Yrs  = array(dim=n_reg)      # Number of years to achieve stability in all points
last = array(dim=n_reg)      # Last point to ground
for (i in 1:n_reg)
{
reg = which(mask_super==i)
Dt=array(dim=c(length(TOPO_BEDMAP2$H[reg])))
Dt=(Dep[reg]-TOPO_BEDMAP2$H[reg])/table3$`dH/dt (2071-2100) [m/yr]`[i] #Time to achieve stability (yr)
Yrs[i] = max(Dt, na.rm=TRUE)
}
Yrs
which(mask_super==20)
TOPO_BEDMAP2[which(mask_super==20)]
TOPO_BEDMAP2$H[which(mask_super==20)]
Dep
H
TOPO_BEDMAP2$H[reg]
TOPO_BEDMAP2$H
Dt
source('~/TFM/mimhao_smb/calculations.r')
Yrs
table7 = def[nms2]
table7
table7[3]=Yrs
table7+
)
table7
table7[2]
table7[2][0]="Time to achieve stability [yr]"
table7[2]=Yrs
table7[2]=Yrs
table7[2]=0,Yrs
table7[2]=0 Yrs
table7[2]=c(1,Yrs)
table7
names(table7)
names(table7[2])
names(table2)="Time to achieve stability [yr]"
table7[2]=Yrs
names(table7)
names(table7[2])=3
names(table7[2])
table7
names(table7[2])="Hola mundo"
names(table7[2])
names(table7[2])<-"Hola mundo"
names(table7[2])
names(table7[2])<-"Hola.mundo"
names(table7[2])
rm(table7)
table7=data.frame()
table7
table7[[1]]
table7[1]
table7[1]=Yrs[i]
table7[1]=Yrs
table7
Yrs
rm(table7)
table7=data.frame()
table7[1]=Yrs
rm(table7)
rm(table7)
table7 = def[nms2]
names(table7)[2] ="Time to achieve stability [yr]"
table7[2] = Yrs
table7
rm(table7)
table7 = def[nms2]
table7[2] = Yrs
names(table7)[2] ="Time to achieve stability [yr]"
table7[2]
rm(table7)
table7 = def[nms2]
table7[2][[1:21]] = Yrs
names(table7)[2] ="Time to achieve stability [yr]"
table7
table7[2][[1:21]]
rm(table7)
ls
table7
table7 = def[nms2][0:21]
def[nms2]
def[nms2][1:22]
nms3
nms3 = names(def)[c(1)]
nms3
table7 = def[nms3]
table7
rm(table7[22])
Yrs
Yrs[22]
Yrs[22]=max(Yrs)
Yrs
rm(table7)
table7
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7
table7[2]
table7[[2]]
table7[1]
table7 = c(def[nms3],2)
table7
rm(table7)
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7
table$names
table$Names
table$Name
table$`Name`
table7$`Name`
table7$Name
table7$ANEFN=Yrs
table7
rm(table7)
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$Stability.time[yr]
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$"Stability.time[yr]"
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$"Stability.time[yr]"=Yrs
table7
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$"Stability.time[yr]"=Yrs
pdf(file.path(outfldr,"table6.pdf"),height=10, width=10)
grid.table(table6)
dev.off()
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$"Stability.time[yr]"=Yrs
pdf(file.path(outfldr,"table7.pdf"),height=10, width=10)
grid.table(table7)
dev.off()
source('~/TFM/mimhao_smb/calculations.r')
source('~/TFM/mimhao_smb/calculations.r')
map_Yr
kk
map_Yr[kk]
Yrs+2071
int(Yrs+2071)
as.integer(Yrs+2071)
rm(table7)
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$Stability.time.yr=Yrs
table7$Stability.year=as.integer(Yrs+2071)
pdf(file.path(outfldr,"table7.pdf"),height=10, width=10)
grid.table(table7)
dev.off()
table7
as.integer(Yrs+2071, is.na=FALSE)
as.integer(Yrs+2071, is.na=TRUE)
rm(table6)
table6 = def[nms2]
table6[c(3,4)]=def[c(22,23)]
table6[5]=def[30]
table6[6]=def[32]
names(table6)[1]  = "Ice shelves"
names(table6)[2]  = "Area [km2]"
names(table6)[3]  = "SMB (2071-2100) [Gt/yr]"
names(table6)[4]  = "SMB (2071-2100) [mm/yr]"
names(table6)[5]  = "Precip. offset (2071-2100) [mm/yr]"
names(table6)[6]  = "Precip. offset (2071-2100) [%]"
#Save table6 to a pdf file
pdf(file.path(outfldr,"table6.pdf"),height=10, width=20)
grid.table(table6)
dev.off()
brks   = seq(0,max(15400),by=2)
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
source("functions_plotting.r")
brks   = seq(0,max(15400),by=2)
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks   = seq(0,15400,by=2)
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks
col
map_Yr(is.na=FALSE)
map_Yr
map_Yr = mask_super*NA
for (q in 1:n_reg) {
kk = which(mask_super==q)
map_Yr[kk] = table7$Stability.time.yr[q]
}
map_YrN = mask_super*NA
for (q in 1:n_reg) {
kk = which(mask_super==q)
map_YrN[kk] = table7$Stability.year[q]
}
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$Stability.time.yr=Yrs
table7$Stability.year=as.integer(Yrs+2071)
pdf(file.path(outfldr,"table7.pdf"),height=10, width=10)
grid.table(table7)
dev.off()
brks
col
brks   = seq(0,15400,by=2) #NUMBER OF YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks   = seq(0,17500,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearsN",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
brks   = seq(-110,190,by=10)
col    = colorRampPalette(palette2,bias=1.5)(length(brks)-1)
# brks1  = seq(-20,20,length.out=11)
# col1   = colorRampPalette(palette2,bias=1)(length(brks1)-1)
myfigure(outfldr,"map_glgerovirwh",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_gl,mask_ice,mask_super,breaks=brks,col=col,title="GL [Gt/yr]")
graphics.off()
palette1 = c("darkblue","blue4","blue2","khaki1","red","red4")
palette2 = c("darkblue","blue4","blue2","white","orange","red","red4")
palette3 = c("darkblue","blue4","blue2","cyan","white") #to plot precipitation (always negative)
palette4 = c("white", "khaki1","red","red4") #to plot projected dH/dt and oceanic temperature anomalies (always positives)
palette5 = c("red4", "red", "khaki1", "white") #to plot unstable areas
palette6 = c("darkblue","blue2","white","red","red4") #to plot unstable areas
brks   = seq(0,15400,by=2) #NUMBER OF YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks   = seq(0,17500,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearsN",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
brks   = seq(2071,17500,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearsN",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
round(1.434)
round(2)
round(2,24234)
round(2.24234)
round(2.24234, digits=1)
round(2.24234, digits=0)
source('~/TFM/mimhao_smb/calculations.r')
which(table7=is.nan)
which(table7=is.nan())
which(is.nan(table7))
(is.nan(table7)
(is.nan(table7))
)
is.na(table7)
which(is.na(table7))
table7[which(is.na(table7))]
table7[64]
table7[[which(is.na(table7))]]
table7[[64]]
table7$Stability.year[64]
table7$Stability.year[which(is.na(table7))]
is.infinite()
is.infinite(table7)
is.infinite(table7$Stability.time.yr)
rm(TOPO_BEDMAP2)
load()
sljr
source('load_data.r)
source('load_data.r')
source('load_data.r')
Dep  = - TOPO_BEDMAP2$zb     # Depth with positive sign
Yrs  = array(dim=n_reg)      # Number of years to achieve stability in all points
for (i in 1:n_reg)
{
reg = which(mask_super==i)
abovesl = which(Dep[reg]<0) #Which values are above sea level (negative depths)
Dep[reg][abovesl] = NA #In our study we eliminate points above sea level
TOPO_BEDMAP2$H[reg][abovesl] = NA #In our study we eliminate points above sea level
Dt=array(dim=c(length(TOPO_BEDMAP2$H[reg])))
Dt=(Dep[reg]-(916.8/1000)*TOPO_BEDMAP2$H[reg])/table3$`dH/dt (2071-2100) [m/yr]`[i] #Time to achieve stability (yr)
Yrs[i] = max(Dt, na.rm=TRUE)
}
Yrs[22]=max(Yrs) #Time to recover the stability in all Antarctica
Yrs #Show the years on screen
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$Stability.time.yr=round(Yrs)
table7$Stability.year=as.integer(Yrs+2071)
table7$Stability.year[which(is.na(table7))]=2071
table7$Stability.time.yr[which(is.na(table7$Stability.time.yr))]=0
pdf(file.path(outfldr,"table7.pdf"),height=10, width=10)
grid.table(table7)
dev.off()
map_Yr = mask_super*NA
for (q in 1:n_reg) {
kk = which(mask_super==q)
map_Yr[kk] = table7$Stability.time.yr[q]
}
map_YrN = mask_super*NA
for (q in 1:n_reg) {
kk = which(mask_super==q)
map_YrN[kk] = table7$Stability.year[q]
}
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$Stability.time.yr=round(Yrs)
table7$Stability.year=as.integer(Yrs+2071)
table7$Stability.year[which(is.na(table7))]=2071
table7$Stability.time.yr[which(is.na(table7$Stability.time.yr))]=0
pdf(file.path(outfldr,"table7.pdf"),height=10, width=10)
grid.table(table7)
dev.off()
table7$Stability.year[which(is.na(table7))]=2071
table7$Stability.year[which(is.na(table7))]
table7$Stability.year[which(is.na(table7))]=2071
table7$Stability.year[which(is.na(table7$Stability.year))]=2071
table7$Stability.year[which(is.na(table7$Stability.year))]
table7
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$Stability.time.yr=round(Yrs)
table7$Stability.year=as.integer(Yrs+2071)
table7$Stability.year[which(is.na(table7$Stability.year))]=2071
table7$Stability.time.yr[which(is.infinite(table7$Stability.time.yr))]=0
pdf(file.path(outfldr,"table7.pdf"),height=10, width=10)
grid.table(table7)
dev.off()
table7
source('~/TFM/mimhao_smb/calculations.r')
rm table7
rm(table7)
nms3 = names(def)[c(1)]
table7 = def[nms3]
table7$Stability.time.yr=round(Yrs)
table7$Stability.year=as.integer(Yrs+2071)
table7$Stability.year[which(is.na(table7$Stability.year))]="Alredy grounded"
table7$Stability.time.yr[which(is.infinite(table7$Stability.time.yr))]=0
pdf(file.path(outfldr,"table7.pdf"),height=10, width=10)
grid.table(table7)
dev.off()
table7
brks   = seq(0,15400,by=2) #NUMBER OF YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks   = seq(2071,17500,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearsN",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
source("functions_plotting.r")
brks   = seq(0,15400,by=2) #NUMBER OF YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks   = seq(2071,17500,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearsN",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
# Load plotting functions
source("functions_plotting.r")
# zlim = range(map_gl, na.rm=TRUE)
# z1 = zlim[1]
# z2 = zlim[2]
# zint = 10
# brks = seq(z1,z2,length.out=zint)
# # col    = c("red","blue")
# # col = rainbow(length(zlim)-1)
# col=colorRampPalette(c("darkmagenta","darkblue","blue","khaki1","red","red4"))(length(brks)-1)
# par(mfrow=c(1,3))
# asp=1.2,pointsize=12
# asp=2.4,pointsize=7
# Map variables by basin
palette1 = c("darkblue","blue4","blue2","khaki1","red","red4")
palette2 = c("darkblue","blue4","blue2","white","orange","red","red4")
palette3 = c("darkblue","blue4","blue2","cyan","white") #to plot precipitation (always negative)
palette4 = c("white", "khaki1","red","red4") #to plot projected dH/dt and oceanic temperature anomalies (always positives)
palette5 = c("red4", "red", "khaki1", "white") #to plot unstable areas
palette6 = c("darkblue","blue2","white","red","red4") #to plot unstable areas
brks   = seq(0,15400,by=2) #NUMBER OF YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks   = seq(2071,17500,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearsN",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
seq(0,1000)
seq(0,1000,by=2)
seq(0,1000,by=2;1000,10000)
Yrs
brks=c(seq(0,10,by=1),seq(10,100,by=2),seq(100,1000,by=20),seq(1000,10000,by=200),seq(10000,100000,by=2000))
brks
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks=c(seq(0,10,by=1),seq(10,100,by=10),seq(100,1000,by=100),seq(1000,10000,by=1000),seq(10000,100000,by=10000))
brks
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
rm(brks)
rm(col)
brks   = seq(0,15400,by=2) #NUMBER OF YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_years",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_Yr,mask_ice,mask_super,breaks=brks,col=col,title="Time to achieve stability (Since 2071) [Yr]")
graphics.off()
brks   = seq(2071,17500,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearsN",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
yellow
col
col()
palette()
plotCol(c("#CC8C3C", paste0("chocolate", 2:4),
paste0("darkorange", c("",1:2)), paste0("darkgoldenrod", 1:2),
"orange", "orange1", "sandybrown", "tan1", "tan2"),
nrow=2)
plotCol(c("#CC8C3C", paste0("chocolate", 2:4),
paste0("darkorange", c("",1:2)), paste0("darkgoldenrod", 1:2),
"orange", "orange1", "sandybrown", "tan1", "tan2"),
nrow=2)
palatte7 = c("#CC8C3C", paste0("chocolate", 2:4),
paste0("darkorange", c("",1:2)), paste0("darkgoldenrod", 1:2),
"orange", "orange1", "sandybrown", "tan1", "tan2")
col    = colorRampPalette(palette7)(length(brks)-1)
palette7 = c("#CC8C3C", paste0("chocolate", 2:4),
paste0("darkorange", c("",1:2)), paste0("darkgoldenrod", 1:2),
"orange", "orange1", "sandybrown", "tan1", "tan2")
rm(palatte7)
brks   = seq(2071,3000,by=2) #YEARS
col    = colorRampPalette(palette7)(length(brks)-1)
myfigure(outfldr,"map_yearszoom",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
palette7 = c("darkorange", "darkgoldenrod",
"orange", "orange1", "sandybrown", "tan1", "tan2")
brks   = seq(2071,3000,by=2) #YEARS
col    = colorRampPalette(palette7)(length(brks)-1)
myfigure(outfldr,"map_yearszoom",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
rm(palette7)
palette7 = c("white", "khaki1", "yellow", "orange", "orange1", "darkorange")
brks   = seq(2071,3000,by=2) #YEARS
col    = colorRampPalette(palette7)(length(brks)-1)
myfigure(outfldr,"map_yearszoom",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
palette7 = c("white", "khaki1", "yellow", "orange", "darkorange")
brks   = seq(2071,3000,by=2) #YEARS
col    = colorRampPalette(palette7)(length(brks)-1)
myfigure(outfldr,"map_yearszoom",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
palette7 = c("white", "khaki1", "yellow", "orange", "red4")
brks   = seq(2071,3000,by=2) #YEARS
col    = colorRampPalette(palette7)(length(brks)-1)
myfigure(outfldr,"map_yearszoom",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
brks   = seq(2071,3000,by=2) #YEARS
col    = colorRampPalette(palette6)(length(brks)-1)
myfigure(outfldr,"map_yearszoom",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
brks   = seq(2071,3000,by=2) #YEARS
col    = colorRampPalette(palette4)(length(brks)-1)
myfigure(outfldr,"map_yearszoom",type="png",asp=1.2,pointsize=12)
plot_antarctica(Xc,Yc,map_YrN,mask_ice,mask_super,breaks=brks,col=col,title="Stability year")
graphics.off()
