source('~/TFM/mimhao_smb/calculations.r')
source('~/TFM/mimhao_smb/calculations.r')
image.plot(groundline$u)
image.plot(mask_)
image.plot(mask_u)
image.plot(mask_v)
image.plot(mask_u)
image.plot(mask_u)
image.plot(mask_v)
image.plot(groundline$u)
image.plot(groundline$v)
flux_gl_v = ((-groundline$v * 40e3 * h + -groundline$v * 40e3 * h) /1e6)
flux_gl_v_plot = apply(flux_gl_v, c(1,2), function(x) if (x==0) NA else x) #CHANGED
image.plot(Xc,Yc, flux_gl_v_plot)
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl*region_mask[[i]]$ice)  #CHANGED
}
df_gl
df_gl_v
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl_v*region_mask[[i]]$ice)  #CHANGED
}
df_gl
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl_v*region_mask[[i]]$ice)  #CHANGED
}
df_gl
flux_gl_v_plot
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl_v*region_mask[[i]]$land)  #CHANGED
}
df_gl
sum(df_gl)
icelon
flux_gl_v = ((groundline$v * 40e3 * h + groundline$v * 40e3 * h) /1e6)
flux_gl_v_plot = apply(flux_gl_v, c(1,2), function(x) if (x==0) NA else x) #CHANGED
image.plot(Xc,Yc, flux_gl_v_plot)
image.plot(VEL_R11$u)
image.plot(VEL_R11$v)
image.plot(VEL_R11$u)
image.plot(VEL_R11$uv)
image.plot(VEL_R11$u)
image.plot(VEL_R11$v)
flux_gl = ((-groundline$v * 40e3 * h + -groundline$u * 40e3 * h) /1e6)
flux_gl_plot = apply(flux_gl_v, c(1,2), function(x) if (x==0) NA else x) #CHANGED
image.plot(Xc,Yc, flux_gl_plot)
#flux_gl = flux_gl_u + flux_gl_v
#df_gl = data.frame(row.names=index)
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl*region_mask[[i]]$land)  #CHANGED
}                                                                    #CHANGED
df_fl
df_gl
sum(df_gl)
source("function_regions_backup.r")
regions_uv <- function(mask,vi=1,vo=0) #the value of the sea is 0 in mask_ice_land and mask_ice_ice
{
## Return the mask of velocity u and v with the sign of dS
mask_u <- array(0,dim(mask))
mask_v <- array(0,dim(mask))
mask_2 <- apply(mask, c(1, 2), function(x) if (x==vo) vo else vi) #ORIGINAL WAS "vi else vo"
for (i in 2:(dim(mask)[1]-1)){
for (j in 2:(dim(mask)[2]-1)){
#             if (mask[i,j] == vi){
#                 if (mask[i,j+1]==vo | mask[i,j-1]==vo){
#                     mask_u[i,j] <- mask_2
#                 }else if (mask[i+1,j]==vo | mask[i-1,j]==vo){
#                     mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1]
#                 }
#             }
if (mask[i,j] == vi){ #ORIGINAL WAS "vo"
if (mask[i,j+1]==vo){
mask_v[i,j] <- mask_2[i,j+1] - mask_2[i,j] # -1
}else if (mask[i,j-1]==vo){
mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1] # +1
}else if (mask[i+1,j]==vo){
mask_u[i,j] <- mask_2[i+1,j] - mask_2[i,j] # -1
}else if (mask[i-1,j]==vo){
mask_u[i,j] <- mask_2[i,j] - mask_2[i-1,j] # +1
}
}
}
}
mask_uv <- list(u=mask_u, v=mask_v)
return(mask_uv)
}
groundline = regions_uv(mask_ice_land)
flux_gl = ((-groundline$v * 40e3 * h + -groundline$u * 40e3 * h) /1e6)
flux_gl_plot = apply(flux_gl_v, c(1,2), function(x) if (x==0) NA else x) #CHANGED
image.plot(Xc,Yc, flux_gl_plot)
regions_uv <- function(mask,vi=1,vo=0) #the value of the sea is 0 in mask_ice_land and mask_ice_ice
{
## Return the mask of velocity u and v with the sign of dS
mask_u <- array(0,dim(mask))
mask_v <- array(0,dim(mask))
mask_2 <- apply(mask, c(1, 2), function(x) if (x==vo) vi else v0) #ORIGINAL WAS "vi else vo"
for (i in 2:(dim(mask)[1]-1)){
for (j in 2:(dim(mask)[2]-1)){
#             if (mask[i,j] == vi){
#                 if (mask[i,j+1]==vo | mask[i,j-1]==vo){
#                     mask_u[i,j] <- mask_2
#                 }else if (mask[i+1,j]==vo | mask[i-1,j]==vo){
#                     mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1]
#                 }
#             }
if (mask[i,j] == vi){ #ORIGINAL WAS "vo"
if (mask[i,j+1]==vo){
mask_v[i,j] <- mask_2[i,j+1] - mask_2[i,j] # -1
}else if (mask[i,j-1]==vo){
mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1] # +1
}else if (mask[i+1,j]==vo){
mask_u[i,j] <- mask_2[i+1,j] - mask_2[i,j] # -1
}else if (mask[i-1,j]==vo){
mask_u[i,j] <- mask_2[i,j] - mask_2[i-1,j] # +1
}
}
}
}
mask_uv <- list(u=mask_u, v=mask_v)
return(mask_uv)
}
groundline = regions_uv(mask_ice_land)
groundline = regions_uv(mask_ice_land)
regions_uv <- function(mask,vi=1,vo=0) #the value of the sea is 0 in mask_ice_land and mask_ice_ice
{
## Return the mask of velocity u and v with the sign of dS
mask_u <- array(0,dim(mask))
mask_v <- array(0,dim(mask))
mask_2 <- apply(mask, c(1, 2), function(x) if (x==vo) vi else v0) #ORIGINAL WAS "vi else vo"
for (i in 2:(dim(mask)[1]-1)){
for (j in 2:(dim(mask)[2]-1)){
#             if (mask[i,j] == vi){
#                 if (mask[i,j+1]==vo | mask[i,j-1]==vo){
#                     mask_u[i,j] <- mask_2
#                 }else if (mask[i+1,j]==vo | mask[i-1,j]==vo){
#                     mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1]
#                 }
#             }
if (mask[i,j] == vi){ #ORIGINAL WAS "vo"
if (mask[i,j+1]==vo){
mask_v[i,j] <- mask_2[i,j+1] - mask_2[i,j] # -1
}else if (mask[i,j-1]==vo){
mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1] # +1
}else if (mask[i+1,j]==vo){
mask_u[i,j] <- mask_2[i+1,j] - mask_2[i,j] # -1
}else if (mask[i-1,j]==vo){
mask_u[i,j] <- mask_2[i,j] - mask_2[i-1,j] # +1
}
}
}
}
mask_uv <- list(u=mask_u, v=mask_v)
return(mask_uv)
}
groundline = regions_uv(mask_ice_land)
## Return the mask of velocity u and v with the sign of dS
mask_u <- array(0,dim(mask))
mask_v <- array(0,dim(mask))
mask_2 <- apply(mask, c(1, 2), function(x) if (x==vo) vi else vo) #ORIGINAL WAS "vi else vo"
for (i in 2:(dim(mask)[1]-1)){
for (j in 2:(dim(mask)[2]-1)){
#             if (mask[i,j] == vi){
#                 if (mask[i,j+1]==vo | mask[i,j-1]==vo){
#                     mask_u[i,j] <- mask_2
#                 }else if (mask[i+1,j]==vo | mask[i-1,j]==vo){
#                     mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1]
#                 }
#             }
if (mask[i,j] == vi){ #ORIGINAL WAS "vo"
if (mask[i,j+1]==vo){
mask_v[i,j] <- mask_2[i,j+1] - mask_2[i,j] # -1
}else if (mask[i,j-1]==vo){
mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1] # +1
}else if (mask[i+1,j]==vo){
mask_u[i,j] <- mask_2[i+1,j] - mask_2[i,j] # -1
}else if (mask[i-1,j]==vo){
mask_u[i,j] <- mask_2[i,j] - mask_2[i-1,j] # +1
}
}
}
}
mask_uv <- list(u=mask_u, v=mask_v)
return(mask_uv)
}
egions_uv <- function(mask,vi=1,vo=0) #the value of the sea is 0 in mask_ice_land and mask_ice_ice
{
## Return the mask of velocity u and v with the sign of dS
mask_u <- array(0,dim(mask))
mask_v <- array(0,dim(mask))
mask_2 <- apply(mask, c(1, 2), function(x) if (x==vo) vi else vo) #ORIGINAL WAS "vi else vo"
for (i in 2:(dim(mask)[1]-1)){
for (j in 2:(dim(mask)[2]-1)){
#             if (mask[i,j] == vi){
#                 if (mask[i,j+1]==vo | mask[i,j-1]==vo){
#                     mask_u[i,j] <- mask_2
#                 }else if (mask[i+1,j]==vo | mask[i-1,j]==vo){
#                     mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1]
#                 }
#             }
if (mask[i,j] == vi){ #ORIGINAL WAS "vo"
if (mask[i,j+1]==vo){
mask_v[i,j] <- mask_2[i,j+1] - mask_2[i,j] # -1
}else if (mask[i,j-1]==vo){
mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1] # +1
}else if (mask[i+1,j]==vo){
mask_u[i,j] <- mask_2[i+1,j] - mask_2[i,j] # -1
}else if (mask[i-1,j]==vo){
mask_u[i,j] <- mask_2[i,j] - mask_2[i-1,j] # +1
}
}
}
}
mask_uv <- list(u=mask_u, v=mask_v)
return(mask_uv)
}
egions_uv <- function(mask,vi=1,vo=0) #the value of the sea is 0 in mask_ice_land and mask_ice_ice
{
## Return the mask of velocity u and v with the sign of dS
mask_u <- array(0,dim(mask))
mask_v <- array(0,dim(mask))
mask_2 <- apply(mask, c(1, 2), function(x) if (x==vo) vi else vo) #ORIGINAL WAS "vi else vo"
for (i in 2:(dim(mask)[1]-1)){
for (j in 2:(dim(mask)[2]-1)){
#             if (mask[i,j] == vi){
#                 if (mask[i,j+1]==vo | mask[i,j-1]==vo){
#                     mask_u[i,j] <- mask_2
#                 }else if (mask[i+1,j]==vo | mask[i-1,j]==vo){
#                     mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1]
#                 }
#             }
if (mask[i,j] == vi){ #ORIGINAL WAS "vo"
if (mask[i,j+1]==vo){
mask_v[i,j] <- mask_2[i,j+1] - mask_2[i,j] # -1
}else if (mask[i,j-1]==vo){
mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1] # +1
}else if (mask[i+1,j]==vo){
mask_u[i,j] <- mask_2[i+1,j] - mask_2[i,j] # -1
}else if (mask[i-1,j]==vo){
mask_u[i,j] <- mask_2[i,j] - mask_2[i-1,j] # +1
}
}
}
}
mask_uv <- list(u=mask_u, v=mask_v)
return(mask_uv)
}
## Function to extract the vectors 'u' and 'v' #################################
regions_uv <- function(mask,vi=1,vo=0) #the value of the sea is 0 in mask_ice_land and mask_ice_ice
{
## Return the mask of velocity u and v with the sign of dS
mask_u <- array(0,dim(mask))
mask_v <- array(0,dim(mask))
mask_2 <- apply(mask, c(1, 2), function(x) if (x==vo) vi else vo) #ORIGINAL WAS "vi else vo"
for (i in 2:(dim(mask)[1]-1)){
for (j in 2:(dim(mask)[2]-1)){
#             if (mask[i,j] == vi){
#                 if (mask[i,j+1]==vo | mask[i,j-1]==vo){
#                     mask_u[i,j] <- mask_2
#                 }else if (mask[i+1,j]==vo | mask[i-1,j]==vo){
#                     mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1]
#                 }
#             }
if (mask[i,j] == vi){ #ORIGINAL WAS "vo"
if (mask[i,j+1]==vo){
mask_v[i,j] <- mask_2[i,j+1] - mask_2[i,j] # -1
}else if (mask[i,j-1]==vo){
mask_v[i,j] <- mask_2[i,j] - mask_2[i,j-1] # +1
}else if (mask[i+1,j]==vo){
mask_u[i,j] <- mask_2[i+1,j] - mask_2[i,j] # -1
}else if (mask[i-1,j]==vo){
mask_u[i,j] <- mask_2[i,j] - mask_2[i-1,j] # +1
}
}
}
}
mask_uv <- list(u=mask_u, v=mask_v)
return(mask_uv)
}
groundline = regions_uv(mask_ice_land)
flux_gl = ((-groundline$v * 40e3 * h + -groundline$u * 40e3 * h) /1e6)
flux_gl_plot = apply(flux_gl_v, c(1,2), function(x) if (x==0) NA else x) #CHANGED
image.plot(Xc,Yc, flux_gl_plot)
#flux_gl = flux_gl_u + flux_gl_v
#df_gl = data.frame(row.names=index)
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl*region_mask[[i]]$land)  #CHANGED
}                                                                    #CHANGED
df_gl
sum(df_gl)
#df_gl = data.frame(row.names=index)
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl_v*region_mask[[i]]$ice)  #CHANGED
}                                                                    #CHANGED
df_gl
source('~/TFM/mimhao_smb/calculations.r')
df_gl
sum(df_gl)
source('~/TFM/mimhao_smb/calculations.r')
source('~/TFM/mimhao_smb/calculations.r')
df_gl
sum(df_gl)
image.plot(VEL_R11$u)
image.plot(VEL_R11$v)
image.plot(VEL_R11$uv)
image.plot(grounline$u)
image.plot(groundline$u)
image.plot(groundline$v)
##flux_gl_u = -groundline$u * icelon * VEL_R11$u
flux_gl_u = (-groundline$u * 40e3 * VEL_R11$u * h /1e6) #CHANGED
flux_gl_v = (-groundline$v * 40e3 * VEL_R11$v * h /1e6) #CHANGED
#flux_gl_v = ((-groundline$v * 40e3 * h + -groundline$v * 40e3 * h) /1e6)
flux_gl_v_plot = apply(flux_gl_v, c(1,2), function(x) if (x==0) NA else x) #CHANGED
flux_gl_u_plot = apply(flux_gl_u, c(1,2), function(x) if (x==0) NA else x) #CHANGED
image.plot(Xc,Yc, flux_gl_v_plot)
flux_gl = flux_gl_u + flux_gl_v
#df_gl = data.frame(row.names=index)
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl_v*region_mask[[i]]$land)  #CHANGED
}       print(flux_gl)
##flux_gl_u = -groundline$u * icelon * VEL_R11$u
flux_gl_u = (-groundline$u * 40e3 * VEL_R11$u * h *0.916/1e9) #CHANGED
flux_gl_v = (-groundline$v * 40e3 * VEL_R11$v * h *0.916/1e9) #CHANGED
#flux_gl_v = ((-groundline$v * 40e3 * h + -groundline$v * 40e3 * h) /1e6)
flux_gl_v_plot = apply(flux_gl_v, c(1,2), function(x) if (x==0) NA else x) #CHANGED
flux_gl_u_plot = apply(flux_gl_u, c(1,2), function(x) if (x==0) NA else x) #CHANGED
image.plot(Xc,Yc, flux_gl_v_plot)
flux_gl = flux_gl_u + flux_gl_v
print(flux_gl)
#df_gl = data.frame(row.names=index)
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum(flux_gl_v*region_mask[[i]]$land)  #CHANGED
}
flux_gl
flux_gl_u
source('~/TFM/mimhao_smb/calculations.r')
image.plot(groundline$u)
image.plot(abs(groundline$u))
image.plot(abs(groundline$u)+abs(groundline$v))
image.plot(landcontour+abs(groundline$u)+abs(groundline$v))
image.plot(landcontour-abs(groundline$u)-abs(groundline$v))
sum(landcontour-abs(groundline$u)-abs(groundline$v))
image.plot(abs(groundline$u))
source('~/TFM/mimhao_smb/calculations.r')
source('~/TFM/mimhao_smb/calculations.r')
df_gl
sum(df_gl)
source('~/TFM/mimhao_smb/calculations.r')
sum(df_gl)
for (i in 1:length(index)){                                          #CHANGED
df_gl[i,"groundline-bm"]    = sum((flux_gl_v+flux_gl_u)*region_mask[[i]]$land)  #CHANGED
}
df_gl
sum(df_gl)
df_gl[1]
df_gl[[i]
df_gl[[1]]
df_gl[[1]]
df_gl
df_gl[1, "groundline-bm"]
flux_gl = sum(flux_gl_u + flux_gl_v)
image.plot(Xc,Yc, flux_gl_v_plot)
image.plot(flux_gl_v_plot)
image.plot(Xc,Yc, flux_gl_v_plot)
source('~/TFM/mimhao_smb/calculations.r')
source('~/TFM/mimhao_smb/calculations.r')
## Plot of the topography of the Antarctica
pdf(file.path(outfldr,"TOPO_BEDMAP2.pdf"))
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
#image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}#The following code in this loop is written to put the number of the regions in the plot
#current_basin = which(region_mask[[i]]$land+region_mask[[i]]$ice!=0, arr.ind=TRUE)
#basin_coordinates[i] = current_basin[8] #We take the first coincidence
#text(Xc[basin_coordinates[i]], Yc[basin_coordinates[i]] ,label = i)
}
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
#image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}#The following code in this loop is written to put the number of the regions in the plot
#current_basin = which(region_mask[[i]]$land+region_mask[[i]]$ice!=0, arr.ind=TRUE)
#basin_coordinates[i] = current_basin[8] #We take the first coincidence
#text(Xc[basin_coordinates[i]], Yc[basin_coordinates[i]] ,label = i)
}
source('~/TFM/mimhao_smb/calculations.r')
colors = c('chocolate4', 'orange', 'lightblue4', 'lightskyblue', 'blue',
'mediumspringgreen', 'firebrick4', 'gold', 'darkolivegreen',
'sandybrown', 'aquamarine4', 'darkgoldenrod', 'gray80', 'seagreen',
'pink3', 'khaki1', 'darkred', 'green', 'magenta', 'lightsteelblue',
'mediumblue', 'lightsalmon', 'aquamarine', 'yellow2', 'cadetblue1',
'darkorange', 'darkgreen')
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
#image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}#The following code in this loop is written to put the number of the regions in the plot
#current_basin = which(region_mask[[i]]$land+region_mask[[i]]$ice!=0, arr.ind=TRUE)
#basin_coordinates[i] = current_basin[8] #We take the first coincidence
#text(Xc[basin_coordinates[i]], Yc[basin_coordinates[i]] ,label = i)
}
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}#The following code in this loop is written to put the number of the regions in the plot
#current_basin = which(region_mask[[i]]$land+region_mask[[i]]$ice!=0, arr.ind=TRUE)
#basin_coordinates[i] = current_basin[8] #We take the first coincidence
#text(Xc[basin_coordinates[i]], Yc[basin_coordinates[i]] ,label = i)
}
contour(Xc, Yc, mask_ice_land, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="red1") #grounding line contour
contour(Xc, Yc, mask_ice_all, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="black") #total contour
title("Antarctica (TOPO BEDMAP2)")
dev.off()
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}#The following code in this loop is written to put the number of the regions in the plot
#current_basin = which(region_mask[[i]]$land+region_mask[[i]]$ice!=0, arr.ind=TRUE)
#basin_coordinates[i] = current_basin[8] #We take the first coincidence
#text(Xc[basin_coordinates[i]], Yc[basin_coordinates[i]] ,label = i)
}
contour(Xc, Yc, mask_ice_land, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="red1") #grounding line contour
contour(Xc, Yc, mask_ice_all, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="black") #total contour
title("Antarctica (TOPO BEDMAP2)")
source('~/TFM/mimhao_smb/calculations.r')
source('~/TFM/mimhao_smb/calculations.r')
help png
help(png)
png(file.path(outfldr,"TOPO_BEDMAP2.png"))
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
#image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}#The following code in this loop is written to put the number of the regions in the plot
#current_basin = which(region_mask[[i]]$land+region_mask[[i]]$ice!=0, arr.ind=TRUE)
#basin_coordinates[i] = current_basin[8] #We take the first coincidence
#text(Xc[basin_coordinates[i]], Yc[basin_coordinates[i]] ,label = i)
}
contour(Xc, Yc, mask_ice_land, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="red1") #grounding line contour
contour(Xc, Yc, mask_ice_all, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="black") #total contour
title("Antarctica (TOPO BEDMAP2)")
dev.off()
png(file.path(outfldr,"TOPO_BEDMAP2.png"))
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
#image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}
}
contour(Xc, Yc, mask_ice_land, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="red1") #grounding line contour
contour(Xc, Yc, mask_ice_all, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="black") #total contour
dev.off()
png(file.path(outfldr,"TOPO_BEDMAP2.png"))
image(Xc, Yc, mask_plot2,col=NA) #first plot
for (i in 1:27){
#image(Xc, Yc, region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i]))
image(Xc, Yc, region_mask[[i]]$land+region_mask[[i]]$ice, add=TRUE, col=c(NA,colors[i])) #plot of each region (27)
for (ii in seq(length=length(Xc))){
for (ij in seq(length=length(Yc))){
if (region_mask[[i]]$ice[ii,ij] != 0) {
points(Xc[ii], Yc[ij], pch = ".", cex = .1) #ice shelves are points
}
}
}
}
contour(Xc, Yc, mask_ice_land, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="red1") #grounding line contour
contour(Xc, Yc, mask_ice_all, nlevels=1, add=TRUE, drawlabels=FALSE,lwd=2, col="black") #total contour
dev.off()
